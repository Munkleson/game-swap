<!-- BANNER -->
<div class="banner">
  <%= image_tag 'banner.png', alt: 'Banner Image', class: 'img-responsive' %>
  <div class="search-bar-container">
    <div class="search-bar">
      <%= simple_form_for :search, url: root_path, method: :get, html: { class: 'form-inline' } do |f| %>
        <div class="input-group">
          <%= f.input :query, label: false, placeholder: "Search for games...", input_html: { value: params[:query], class: 'form-control mr-sm-2' } %>
          <div class="input-group-append">
            <%= f.submit "Search", class: "btn btn-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<!-- CAROUSEL -->
<div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
  <div class="carousel-indicators">
    <% @carousel_groups.each_with_index do |group, index| %>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="<%= index %>" class="<%= 'active' if index == 0 %>" aria-current="<%= 'true' if index == 0 %>" aria-label="Slide <%= index + 1 %>"></button>
    <% end %>
  </div>
  <div class="carousel-inner">
    <% @carousel_groups.each_with_index do |group, index| %>
      <div class="carousel-item <%= 'active' if index == 0 %>">
        <div class="row">
          <% group.each do |listing| %>
            <div class="col-12 col-sm-4 col-md-4 col-lg-2">
              <div class="card mb-4 shadow-sm">
                <% if listing.game.cover.present? %>
                  <%= image_tag listing.game.cover.url, class: 'card-img-top', alt: listing.game.name %>
                <% end %>
                <div class="card-body d-flex flex-column">
                  <h5 class="card-title"><%= listing.game.name %></h5>
                  <p class="card-text"><%= number_to_currency(listing.price, unit: "¥", format: "%u%n") %></p>
                  <%= link_to 'View the Game', listing_path(listing), class: 'btn btn-primary' %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>

<div class="container mt-5">
  <div class="row mt-5">
    <div class="col-md-12">
      <% if @query.present? %>
        <h2>Search Results for "<%= @query %>":</h2>
        <% if @listings.any? %>
          <div class="row">
            <% @listings.each do |listing| %>
              <div class="col-md-4">
                <div class="card mb-4 shadow-sm">
                  <% if listing.game.cover.present? %>
                    <%= image_tag listing.game.cover.url, class: 'card-img-top', alt: listing.game.name %>
                  <% end %>
                  <div class="card-body">
                    <h5 class="card-title"><%= listing.game.name %></h5>
                    <p class="card-text">Price: <%= number_to_currency(listing.price, unit: "¥", format: "%u%n") %></p>
                    <%= link_to 'View Listing', listing_path(listing), class: 'btn btn-primary' %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <p>No listings found.</p>
        <% end %>
      <% end %>
    </div>
  </div>
</div>
